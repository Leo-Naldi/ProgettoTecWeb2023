import{b as N,Q as P,a as O}from"./QItem.ea7b6016.js";import{Q as A}from"./QSeparator.92a6cda9.js";import{Q as G}from"./QList.97ee5378.js";import{Q as H}from"./ClosePopup.da0077f2.js";import{_ as J,a4 as K,Y as R,r as k,S as q,k as j,w as W,b as Y,D as o,E as h,F as l,bt as X,bu as Z,bv as ee,bp as te,bw as se,bx as oe,G as s,x as p,aG as z,H as m,a7 as c,a9 as r,aa as b,ab as C,ai as i,bd as ae,aU as re,b5 as le,Q as ne,bc as f,by as ie,a8 as ue,ae as B,a0 as ce,a1 as de,bz as me}from"./index.b8bea508.js";import{Q as pe,l as he,m as ye,a as _}from"./CloseDialog.f0183c26.js";import{Q as ve}from"./QInput.c0248187.js";import{Q as ge}from"./QPage.0605acda.js";import{S as U}from"./ShowPost.46485ab7.js";import{U as ke}from"./UserEnum.4fc8a66b.js";import{C as fe}from"./ChannelEnum.33074358.js";import{u as _e}from"./searchSideBar.vue_vue_type_style_index_0_scoped_true_lang.aeed4413.js";import"./use-dark.880f3e4e.js";import"./focus-manager.05708ea9.js";import"./QResizeObserver.231b9bb5.js";import"./QCardActions.f9bcb485.js";import"./QForm.0a780925.js";import"./WritePost.1ecdca4f.js";import"./QCheckbox.952440f4.js";import"./format.3e32b8d9.js";import"./map.c8319187.js";import"./ChannelButton.4b56e50f.js";import"./TouchPan.755f1f67.js";const T=x=>(ce("data-v-118d0aa6"),x=x(),de(),x),xe=["onClick"],we=T(()=>m("i",{class:"material-icons"},"close",-1)),be=[we],Ce=T(()=>m("div",{class:"clear"},"clear all history",-1)),Se={class:"q-pt-md"},Qe={class:"q-pt-md"},Ve={class:"q-pt-md"},Pe={class:"q-pt-md"},Be={class:"q-pt-md"},Ue={class:"col q-pa-xs"},Me={key:0},Ie={key:0,style:{"text-align":"center","vertical-align":"center"}},Ne={key:1},Re={key:0,style:{"text-align":"center","vertical-align":"center"}},qe={key:2},ze={key:0,style:{"text-align":"center","vertical-align":"center"}},Te={key:3},$e={key:0,style:{"text-align":"center","vertical-align":"center"}},De={key:4},Fe={key:0,style:{"text-align":"center","vertical-align":"center"}},Le={__name:"MySearch",setup(x){const y=K(),S=R(),d=k("posts"),u=q({showPosts:!0,showChannels:!0,showUsers:!0,showMentions:!0,showTags:!0}),v=y.currentRoute.value.params.searchText?k(y.currentRoute.value.params.searchText):k(""),n=q({posts:[],users:[],channels:[],tags:[],mentions:[]}),g=a=>{d.value=a},M=k(!1),$=j(()=>_e().getSearchFilter),Q=async a=>{var e=JSON.parse(JSON.stringify(X($).value));M.value?(e.contains.text=a,n.posts=await R().searchPostsFiltered(e)):(Z(a),w(),n.posts=await S.searchPosts(a)),n.tags=await S.searchHashtags(a),n.mentions=await S.searchMentions(a),n.users=await ee(a),n.channels=await te(a)},V=k([]),D=()=>{v.value!=""&&y.push({name:"searchWithParam",params:{searchText:v.value}})},w=()=>{se.has("search")&&(V.value=oe())},F=a=>{me(a),w()},L=()=>{ie(),w()};return W(()=>y.currentRoute.value.params,async a=>{a.searchText&&Q(a.searchText)},{deep:!1,immediate:!0}),Y(()=>{const a=y.currentRoute.value.params.searchText;a&&Q(a),console.log("now you're searching for words: ",a),w()}),(a,e)=>(o(),h(ge,{padding:""},{default:l(()=>[s(ve,{class:"q-pb-md",onKeyup:ae(D,["enter"]),modelValue:re(v),"onUpdate:modelValue":e[6]||(e[6]=t=>le(v)?v.value=t:null),placeholder:"Please input the text that you want them show in results",outlined:"",rounded:"",dense:""},{prepend:l(()=>[s(p,{name:"search"})]),after:l(()=>[s(p,{name:"settings",class:"cursor-pointer",onClick:e[5]||(e[5]=z(()=>{},["stop"]))},{default:l(()=>[s(pe,null,{default:l(()=>[s(he,{class:"my-card"},{default:l(()=>[s(ye,null,{default:l(()=>[m("div",Se,[c(" Don't show posts:"),s(_,{modelValue:u.showPosts,"onUpdate:modelValue":e[0]||(e[0]=t=>u.showPosts=t),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),m("div",Qe,[c(" Don't show channels:"),s(_,{modelValue:u.showChannels,"onUpdate:modelValue":e[1]||(e[1]=t=>u.showChannels=t),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),m("div",Ve,[c(" Don't show users:"),s(_,{modelValue:u.showUsers,"onUpdate:modelValue":e[2]||(e[2]=t=>u.showUsers=t),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),m("div",Pe,[c(" Don't show mentions:"),s(_,{modelValue:u.showMentions,"onUpdate:modelValue":e[3]||(e[3]=t=>u.showMentions=t),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),m("div",Be,[c(" Don't show tags:"),s(_,{modelValue:u.showTags,"onUpdate:modelValue":e[4]||(e[4]=t=>u.showTags=t),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])])]),_:1})]),_:1})]),_:1})]),_:1})]),default:l(()=>[V.value.length>0?(o(),h(H,{key:0,fit:""},{default:l(()=>[s(G,{style:{"min-width":"100px"}},{default:l(()=>[(o(!0),r(C,null,b(V.value,(t,I)=>(o(),h(N,{clickable:"",key:I,onClick:E=>Q(t)},{default:l(()=>[s(P,null,{default:l(()=>[c(ue(t),1)]),_:2},1024),s(P,{side:""},{default:l(()=>[m("div",{class:"alert-box-close",onClick:z(E=>F(I),["stop"]),color:"red"},be,8,xe)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),s(A),s(N,{clickable:""},{default:l(()=>[s(P,{onClick:L},{default:l(()=>[Ce]),_:1})]),_:1})]),_:1})]),_:1})):i("",!0)]),_:1},8,["modelValue"]),m("div",null,[c(" It seems that you've choosen some filters to search! click this button to confirm "),s(ne,{size:"sm",onClick:e[7]||(e[7]=t=>M.value=!0)},{default:l(()=>[c("Confirm")]),_:1})]),m("div",Ue,[s(O,{class:"nav-option text-subtitle1 flex justify-around q-py-lg"},{default:l(()=>[u.showPosts===!0?(o(),r("strong",{key:0,onClick:e[8]||(e[8]=t=>g("posts")),style:f([d.value==="posts"?{borderBottom:"2px solid #1da1f2"}:{borderBottom:"2px solid transparent"}])},[s(p,{style:{margin:"0 -3px 3px 0"},color:"grey",name:"reply_all",size:"xs"}),c("\u2002Posts")],4)):i("",!0),u.showChannels===!0?(o(),r("strong",{key:1,onClick:e[9]||(e[9]=t=>g("channel")),style:f([d.value==="channel"?{borderBottom:"2px solid #1da1f2"}:{borderBottom:"2px solid transparent"}])},[s(p,{style:{margin:"0 -3px 3px 0"},color:"grey",name:"movie",size:"xs"}),c("\u2002Channel")],4)):i("",!0),u.showUsers===!0?(o(),r("strong",{key:2,onClick:e[10]||(e[10]=t=>g("user")),style:f([d.value==="user"?{borderBottom:"2px solid #1da1f2"}:{borderBottom:"2px solid transparent"}])},[s(p,{style:{margin:"0 -3px 3px 0"},color:"grey",name:"person",size:"xs"}),c("\u2002User")],4)):i("",!0),u.showMentions===!0?(o(),r("strong",{key:3,onClick:e[11]||(e[11]=t=>g("mention")),style:f([d.value==="mention"?{borderBottom:"2px solid #1da1f2"}:{borderBottom:"2px solid transparent"}])},[s(p,{style:{margin:"0 -3px 6px 0"},color:"grey",name:"@",size:"xs"}),c("\u2002Mention")],4)):i("",!0),u.showTags===!0?(o(),r("strong",{key:4,onClick:e[12]||(e[12]=t=>g("tag")),style:f([d.value==="tag"?{borderBottom:"2px solid #1da1f2"}:{borderBottom:"2px solid transparent"}])},[s(p,{style:{margin:"0 -3px 3px 0"},color:"grey",name:"tag",size:"xs"}),c("\u2002Tag")],4)):i("",!0)]),_:1})]),m("div",null,[d.value==="posts"?(o(),r("div",Me,[(o(!0),r(C,null,b(n.posts,t=>(o(),h(U,B({key:t._id},t,{clickable:""}),null,16))),128)),n.posts.length==0?(o(),r("p",Ie," No result ")):i("",!0)])):i("",!0),d.value==="user"?(o(),r("div",Ne,[s(ke,{members:n.users,clickable:""},null,8,["members"]),n.users.length==0?(o(),r("p",Re," No result ")):i("",!0)])):i("",!0),d.value==="channel"?(o(),r("div",qe,[s(fe,{channels:n.channels,clickable:""},null,8,["channels"]),n.channels.length==0?(o(),r("p",ze," No result ")):i("",!0)])):i("",!0),d.value==="mention"?(o(),r("div",Te,[(o(!0),r(C,null,b(n.mentions,t=>(o(),h(U,B({key:t._id},t,{clickable:""}),null,16))),128)),n.mentions.length==0?(o(),r("p",$e," No result ")):i("",!0)])):i("",!0),d.value==="tag"?(o(),r("div",De,[(o(!0),r(C,null,b(n.tags,t=>(o(),h(U,B({key:t._id},t,{clickable:""}),null,16))),128)),n.tags.length==0?(o(),r("p",Fe," No result ")):i("",!0)])):i("",!0)])]),_:1}))}};var dt=J(Le,[["__scopeId","data-v-118d0aa6"]]);export{dt as default};
