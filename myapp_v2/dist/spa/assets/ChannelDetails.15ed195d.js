import{_ as E,r as x,C as M,D as i,a9 as p,G as e,F as a,j as F,S as T,E as y,ai as h,H as o,aj as J,a7 as v,Q as z,aU as O,a8 as g,bo as H,Y as j,a4 as L,p as W,a5 as Y,w as D,b as G,bp as K,bq as V,aa as N,ab as k,aE as X,bc as Z,ae as ee,a0 as te,a1 as se}from"./index.b8bea508.js";import{p as b,q as P,s as q,t as B,m as ae,h as ne,g as le,l as oe,C as R,Q as U}from"./CloseDialog.f0183c26.js";import{Q as A}from"./QSeparator.92a6cda9.js";import{Q as re}from"./QList.97ee5378.js";import{Q as ie}from"./QPage.0605acda.js";import{S as me}from"./ShowPost.46485ab7.js";import{W as de}from"./WritePost.1ecdca4f.js";import{C as ue}from"./ChannelButton.4b56e50f.js";import{Q}from"./QInput.c0248187.js";import{Q as ce}from"./QCheckbox.952440f4.js";import{Q as $}from"./QForm.0a780925.js";import{U as pe}from"./UserEnum.4fc8a66b.js";import{C as _e}from"./ConfirmPopup.b78e8aa6.js";import"./ClosePopup.da0077f2.js";import"./use-dark.880f3e4e.js";import"./focus-manager.05708ea9.js";import"./QResizeObserver.231b9bb5.js";import"./QCardActions.f9bcb485.js";import"./QItem.ea7b6016.js";import"./format.3e32b8d9.js";import"./map.c8319187.js";const fe={components:{UserEnum:pe},props:{showAdminButton:{type:Boolean,default:!1},forRequests:{type:Boolean,default:!1}},setup(){return{tab:x("members"),request_tab:x("Member-Req")}}},he={key:0,class:"q-gutter-y-md"},be={key:1,class:"q-gutter-y-md"};function qe(w,d,c,m,t,_){const f=M("UserEnum");return c.forRequests?(i(),p("div",he,[e(P,{modelValue:m.request_tab,"onUpdate:modelValue":d[0]||(d[0]=n=>m.request_tab=n),class:"text-grey","active-color":"primary","indicator-color":"primary","narrow-indicator":""},{default:a(()=>[e(b,{name:"Member-Req",label:"Member-Req"}),e(b,{name:"Editor-Req",label:"Editor-Req"})]),_:1},8,["modelValue"]),e(B,{modelValue:m.request_tab,"onUpdate:modelValue":d[1]||(d[1]=n=>m.request_tab=n),animated:""},{default:a(()=>[e(q,{name:"Member-Req"},{default:a(()=>[e(f,{request_member:!0,showAdminButton:c.showAdminButton,request_handler:!0},null,8,["showAdminButton"])]),_:1}),e(q,{name:"Editor-Req"},{default:a(()=>[e(f,{request_editor:!0,showAdminButton:c.showAdminButton,request_handler:!0},null,8,["showAdminButton"])]),_:1})]),_:1},8,["modelValue"])])):(i(),p("div",be,[e(P,{modelValue:m.tab,"onUpdate:modelValue":d[2]||(d[2]=n=>m.tab=n),class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:a(()=>[e(b,{name:"members",label:"Members"}),e(b,{name:"editors",label:"Editors"})]),_:1},8,["modelValue"]),e(B,{modelValue:m.tab,"onUpdate:modelValue":d[3]||(d[3]=n=>m.tab=n),animated:""},{default:a(()=>[e(q,{name:"members"},{default:a(()=>[e(f,{admin_member:!0,showAdminButton:c.showAdminButton,member_handler:!0},null,8,["showAdminButton"])]),_:1}),e(q,{name:"editors"},{default:a(()=>[e(f,{admin_editor:!0,showAdminButton:c.showAdminButton,member_handler:!0},null,8,["showAdminButton"])]),_:1})]),_:1},8,["modelValue"])]))}var S=E(fe,[["render",qe]]);const ye={key:0},ge={key:0,class:"text-h6 q-pb-md text-blue",style:{display:"flex","justify-content":"center"}},ve={key:0,class:"text-h6 q-pb-md text-blue",style:{display:"flex","justify-content":"center"}},we={class:"text-h5 col-12 q-mb-md text-blue-6",style:{cursor:"help"}},Ce={class:"col-md-4 col-sm-5 col-xs-12 q-gutter-y-md q-pt-md q-pl-md q-pb-md"},xe=o("div",{class:"text-h5 col-12 q-mb-md"},"Delete this channel",-1),Ve=o("p",null,"Please insert below the channel name to delete this channel",-1),Qe="Are you sure you want to delete this channel?",Pe={__name:"ChannelSettings",setup(w){const d=F("channelDetails"),c=x(""),m=x(!1),t=T({name:"",description:"",isPrivate:!1}),_=x("see-members");function f(u){return Object.entries(u).reduce((s,[l,C])=>(C!==""&&(l==="isPrivate"&&C==d.isPublic&&(s[l]=C),l!="isPrivate"&&(s[l]=C)),s),{})}async function n(){const u=JSON.parse(JSON.stringify(t)),s=f(u);await H(d.name,s)}const r=()=>{c.value===d.name?m.value=!0:alert("please iinsert again! They're different!")};return(u,s)=>(i(),y(oe,{flat:"",square:""},{default:a(()=>[e(ae,{class:"q-pa-none row"},{default:a(()=>[u.$q.screen.gt.xs?(i(),p("div",ye,[e(P,{modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=l=>_.value=l),align:"left","active-color":"primary","active-bg-color":"blue-1",class:"text-grey-10",vertical:""},{default:a(()=>[e(b,{name:"see-members",label:"members",style:{"justify-content":"left"},"content-class":"q-pl-md"}),e(b,{name:"see-requests",label:"requests",style:{"justify-content":"left"},"content-class":"q-pl-md"}),e(b,{name:"channelSettings",label:"channel settings",style:{"justify-content":"left"},"content-class":"q-pl-md"}),e(b,{name:"deleteChannel",label:"Delete Channel",style:{"justify-content":"left"},"content-class":"q-pl-md"})]),_:1},8,["modelValue"])])):h("",!0),o("div",{class:J(u.$q.screen.gt.xs?"col  q-pt-none":"q-ma-md"),style:{"min-width":"350px"}},[e(B,{swipeable:!u.$q.screen.gt.xs,infinite:!u.$q.screen.gt.xs,modelValue:_.value,"onUpdate:modelValue":s[8]||(s[8]=l=>_.value=l),animated:"","transition-prev":"fade","transition-next":"fade"},{default:a(()=>[e(q,{name:"see-members",class:"q-pt-none"},{default:a(()=>[u.$q.screen.gt.xs?h("",!0):(i(),p("div",ge,"Members")),e(S,{showAdminButton:!0})]),_:1}),e(q,{name:"see-requests",class:"q-pt-sm"},{default:a(()=>[u.$q.screen.gt.xs?h("",!0):(i(),p("div",ve,"Requests")),e(S,{forRequests:!0,showAdminButton:!0})]),_:1}),e(q,{name:"channelSettings",class:"q-pt-sm"},{default:a(()=>[o("div",we,[v("Channel Settings"),e(ne,{class:"bg-grey text-body2",offset:[10,10]},{default:a(()=>[v(" If you do not want to change one of them, please leave them empty ")]),_:1})]),o("div",Ce,[e($,{onSubmit:s[4]||(s[4]=l=>n()),class:"q-gutter-md"},{default:a(()=>[e(Q,{class:"col",outlined:"",dense:"",square:"",label:"name",modelValue:t.name,"onUpdate:modelValue":s[1]||(s[1]=l=>t.name=l)},null,8,["modelValue"]),e(Q,{type:"textarea",outlined:"",dense:"",square:"",label:"personal descriptions",modelValue:t.description,"onUpdate:modelValue":s[2]||(s[2]=l=>t.description=l)},null,8,["modelValue"]),o("div",null,[e(ce,{modelValue:t.isPrivate,"onUpdate:modelValue":s[3]||(s[3]=l=>t.isPrivate=l),label:"Set Private"},null,8,["modelValue"])]),e(z,{label:"update data",type:"submit",color:"primary",unelevated:""})]),_:1})])]),_:1}),e(q,{name:"deleteChannel",class:"q-pt-sm"},{default:a(()=>[xe,e($,{onSubmit:s[7]||(s[7]=l=>r()),class:"q-mt-md"},{default:a(()=>[Ve,e(Q,{class:"col",outlined:"",dense:"",rounded:"",label:"name",modelValue:c.value,"onUpdate:modelValue":s[6]||(s[6]=l=>c.value=l)},{default:a(()=>[e(le,{modelValue:m.value,"onUpdate:modelValue":s[5]||(s[5]=l=>m.value=l),persistent:"",style:{width:"250px"}},{default:a(()=>[e(_e,{"confirm-data":3,channelName:O(d).name},{default:a(()=>[v(g(Qe))]),_:1},8,["channelName"])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["swipeable","infinite","modelValue"])],2)]),_:1})]),_:1}))}};const Be=w=>(te("data-v-0aaee718"),w=w(),se(),w),Se=Be(()=>o("div",{class:"top-img"},null,-1)),je={class:"text-weight-bold text-h4"},De={class:"display: flex; align-items: center; justify-content: center"},Ne={class:""},ke={class:""},Re={class:"text-center text-secondary q-pb-md"},Ue={class:"center-container"},Ae={clickable:"",class:"cursor-pointer",style:{display:"flex","align-items":"center","justify-content":"space-between"}},$e={class:"q-pa-md q-gutter-sm",style:{height:"80px"}},Ee=["src"],Me={style:{"margin-left":"12rem","margin-top":"1rem"}},Te={key:0,style:{order:"2"}},ze={key:3},Ie={key:4},Fe={__name:"ChannelDetails",setup(w){const d=j(),c=L(),m=c.currentRoute.value.params,t=T({name:"",description:NaN,creator:NaN,members_name:[],members:[],editors:[],member_requests:[],editor_requests:[],member_requests_json:[],editor_requests_json:[],messages:[],isEditor:!1,isCreator:!1,isMember:!1,isPublic:!1});W("channelDetails",t);const _=Y().getUserHandle,f=async n=>{t.name=n;const r=await K(n);if(r.length>0){t.description=r[0].description,t.creator=r[0].creator,t.members_name=r[0].members,t.isEditor=r[0].editors.includes(_),t.isCreator=r[0].creator===_,t.member_requests=r[0].memberRequests,t.editor_requests=r[0].editorRequests,t.isPublic=r[0].publicChannel;const u=await V(r[0].members),s=await V(r[0].editors),l=await V(r[0].memberRequests),C=await V(r[0].editorRequests);if(t.members=u,t.editors=s,t.member_requests_json=l,t.editor_requests_json=C,t.isMember=r[0].members.includes(_),t.isMember){const I=await d.fetchChannelPost(n);t.messages=I}}};return D(()=>c.currentRoute.value.params,async n=>{n.channelName&&f(n.channelName)},{deep:!1,immediate:!0}),D(()=>j().getSocketPost,n=>{m&&n.dest.includes("\xA7"+m.channelName)&&t.messages.unshift(n)},{deep:!0}),G(()=>{const n=m.channelName;typeof n!="undefined"&&f(n)}),(n,r)=>{const u=M("router-link");return i(),y(ie,null,{default:a(()=>[Se,o("p",je,g(n.$route.params.channelName),1),o("div",De,[o("p",Ne,"Description: "+g(t.description),1),o("p",ke,"creator: @"+g(t.creator),1),o("div",Re,[v("Now you can see all channel posts "),e(u,{to:{name:"ChannelMap",params:{channels:n.$route.params.channelName}}},{default:a(()=>[v("here")]),_:1},8,["to"]),v(" on the map!")])]),o("div",Ue,[e(ue,{channel:t,channel_name:n.$route.params.channelName,style:{"box-sizing":"content-box","font-size":"15px"}},null,8,["channel","channel_name"])]),o("p",null,"member_requests: "+g(t.member_requests),1),o("p",null,"editors_requests: "+g(t.editor_requests),1),o("div",Ae,[o("div",$e,[(i(!0),p(k,null,N(t.members_name.length,s=>(i(),y(X,{key:s,size:"40px",class:"overlapping",style:Z(`left: ${s*25}px`)},{default:a(()=>[o("img",{src:`https://cdn.quasar.dev/img/avatar${(s+1)%5+1}.jpg`},null,8,Ee)]),_:2},1032,["style"]))),128)),o("div",Me,[o("a",null,g(t.members_name.length),1),v("\xA0 members ")]),e(U,null,{default:a(()=>[e(R,null,{default:a(()=>[e(S)]),_:1})]),_:1})]),t.isCreator?(i(),p("div",Te,[e(z,{flat:"",round:"",icon:"settings",class:"cursor-pointer"},{default:a(()=>[e(U,null,{default:a(()=>[e(R,null,{default:a(()=>[e(Pe)]),_:1})]),_:1})]),_:1})])):h("",!0)]),t.isEditor?(i(),y(A,{key:0,class:"divider",color:"grey-2",size:"10px"})):h("",!0),t.isEditor?(i(),y(de,{key:1,destChannel:n.$route.params.channelName},null,8,["destChannel"])):h("",!0),e(A,{class:"divider",color:"grey-2",size:"10px"}),t.isMember?(i(),y(re,{key:2,separator:""},{default:a(()=>[(i(!0),p(k,null,N(t.messages,s=>(i(),y(me,ee({key:s.id},s,{clickable:""}),null,16))),128))]),_:1})):h("",!0),!t.isMember&&t.messages.length<=0?(i(),p("p",ze,"You're not a member, you cannot see the messages!")):h("",!0),t.isMember&&t.messages.length<=0?(i(),p("p",Ie,"No channel message, create a new message")):h("",!0)]),_:1})}}};var ut=E(Fe,[["__scopeId","data-v-0aaee718"]]);export{ut as default};
